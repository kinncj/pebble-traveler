<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Diagrams - Pebble Traveler</title>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <style>body{font-family:Arial,Helvetica,sans-serif;padding:20px;background:#0f172a;color:#e6eef8} .diagram{background:#071233;padding:16px;border-radius:8px;margin-bottom:24px}</style>
</head>
<body>
  <h1>Pebble Traveler — Diagrams</h1>
  <div class="diagram">
    <h2>System Architecture</h2>
    <div class="mermaid">
      %%{init: {"securityLevel": "loose"}}%%
      flowchart LR
        PhoneApp["Phone App (Clay)"] -->|AppMessage| Watch["Watch (C App)"]
        Watch -->|Persist| Storage[(Persistent Storage)]
        Watch -->|Tick| TimeLib[(system time / localtime/gmtime)]
        Watch -->|Accel Tap| Accel["Accelerometer Service"]
        Watch -->|Display| Screen[TextLayers]
        subgraph Platforms
          Basalt(Basalt)
          Chalk(Chalk)
          Diorite(Diorite)
          Emery(Emery)
        end
        Watch --> Platforms
    </div>
  </div>

  <div class="diagram">
    <h2>AppMessage / Configuration Flow</h2>
    <div class="mermaid">
      sequenceDiagram
        participant User
        participant PhoneApp as "Phone (Clay)"
        participant Watch
        participant Storage
        User->>PhoneApp: Select timezone / colors
        PhoneApp->>Watch: send AppMessage (timezone/color keys)
        Watch->>Watch: inbox_received_callback
        Watch->>Storage: persist_write_* for each key
        Watch->>Watch: update_time_display()
        Watch-->>PhoneApp: outbox_sent (optional ack)
    </div>
  </div>

  <p>Generated diagrams — source files located at <code>docs/generated/*.mmd</code>.</p>
</body>
</html>
